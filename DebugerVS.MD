# Отладчик VS
## Установка точки останова и запуск отладчика
Для отладки нужно запустить приложение с отладчиком, подключенным к процессу приложения.
Для этого чаще всего используется клавиша F5 (Отладка > Начать отладку). Однако сейчас у вас, возможно,
не задано ни одной точки останова для проверки кода приложения, поэтому мы сначала зададим их, а затем начнем отладку.
Точки останова — это один из самых простых и важных компонентов надежной отладки. Точка останова указывает,
где Visual Studio следует приостановить выполнение кода, чтобы вы могли проверить значения переменных или поведение памяти либо выполнение ветви кода.

Если вы открыли файл в редакторе кода, точку останова можно задать, щелкнув в поле слева от строки кода.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-set-a-breakpoint.gif?view=vs-2019)

## Установка точки останова

Нажмите клавишу F5 (Отладка > Начать отладку) или Начать отладку кнопку Начать отладку на панели инструментов отладки,
при этом отладчик выполняется до первой встреченной точки останова. Если приложение еще не запущено,
при нажатии клавиши F5 запускается отладчик и выполняется остановка в первой точке останова.

Точки останова полезны, если вам известны строка или раздел кода, которые вы хотите подробно изучить.

## Переход по коду в отладчике с помощью пошаговых команд
Мы указываем сочетания клавиш для большинства команд, так как они ускоряют навигацию по коду вашего приложения.
(Эквивалентные команды, например команды меню, приведены в круглых скобках.)

Для запуска приложения с подключенным отладчиком нажмите клавишу F11 (Отладка > Шаг с заходом).
F11 — это команда Шаг с заходом, которая выполняет приложение с переходом к следующему оператору.
При запуске приложения с помощью клавиши F11 отладчик останавливается на первом выполняемом операторе.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-f11.png?view=vs-2019)

Желтая стрелка представляет оператор, на котором приостановлен отладчик.
В этой же точке приостанавливается выполнение приложения (этот оператор пока не выполнен).

Клавишу F11 удобно использовать для более детальной проверки потока выполнения.
(Мы также покажем другие варианты более быстрого перемещения по коду.) По умолчанию отладчик пропускает непользовательский код
(дополнительные сведения см. в статье об отладке в режиме "Только мой код").

## Шаг с обходом по коду для пропуска функций
Когда вы находитесь на строке кода, представляющей собой вызов функции или метода, можно нажать клавишу F10 (Отладка > Шаг с обходом) вместо F11.

Клавиша F10 продолжает выполнение отладчика без захода в функции или методы в коде приложения (код продолжает выполняться).
Нажав клавишу F10, вы можете обойти код, который вас не интересует. Так можно быстро перейти к важному для вас коду.

## Шаг с заходом в свойство
Как упоминалось ранее, по умолчанию отладчик пропускает управляемые свойства и поля, однако команда Шаг с заходом в конкретное расположение позволяет переопределить это поведение.

Щелкните правой кнопкой мыши свойство или поле и выберите Шаг с заходом в конкретное расположение, а затем выберите один из доступных параметров.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-step-into-specific.png?view=vs-2019)

В этом примере команда Шаг с заходом в конкретное расположение приводит нас к коду для Path.set.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-step-into-specific-2.png?view=vs-2019)

## Быстрое выполнение до точки в коде с помощью мыши
Находясь в отладчике, наведите курсор на строку кода, пока слева не появится кнопка выполнения до щелкнутого (Выполнить до этого места)
Снимок экрана: кнопка выполнения до щелкнутого в отладчике Visual Studio. Кнопка указывает на то, что выполнение должно происходить до строки,
в которой размещена кнопка. отображается слева.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-run-to-click-2.png?view=vs-2019)

Нажмите кнопку выполнения до щелкнутого (Выполнить до этого места). Отладчик продолжает выполнение до строки кода, которую вы щелкнули.

Использование этой кнопки аналогично установке временной точки останова. Кроме того, эта команда удобна для быстрой работы в видимой области кода приложения.
Выполнение до щелкнутого можно использовать в любом открытом файле.

## Вывод отладчика из текущей функции
В некоторых случаях может потребоваться продолжить сеанс отладки, однако полностью проведя отладчик сквозь текущую функцию.

Нажмите клавиши SHIFT+F11 (или выберите Отладка > Шаг с выходом).

Эта команда возобновляет выполнение приложения (и перемещает отладчик) до возврата текущей функции.

## Выполнить до текущей позиции
Если вы находитесь в режиме редактирования кода (то есть работа отладчика не приостановлена),
щелкните правой кнопкой мыши строку кода в приложении и выберите команду Выполнить до текущей позиции (или нажмите клавиши CTRL+F10).
Эта команда запускает отладку и задает временную точку останова на текущей строке кода.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-run-to-cursor.png?view=vs-2019)

Если имеются заданные точки останова, отладчик приостанавливается в первой достигнутой точке останова.

Нажимайте клавишу F5, пока не достигнете строки кода, для которой выбрали Выполнить до текущей позиции.

Эта команда удобна, когда вы редактируете код и хотите быстро задать временную точку останова и одновременно запустить отладчик.


## Быстрый перезапуск приложения
Нажмите кнопку Перезапустить Перезапустить приложение на панели инструментов отладки (или нажмите клавиши CTRL+SHIFT+F5).

Кнопка Перезапустить позволяет сэкономить время, затрачиваемое на остановку приложения и перезапуск отладчика.
Отладчик приостанавливается в первой точке останова, достигнутой при выполнении кода.

Если вы хотите остановить отладчик и вернуться в редактор кода, вы можете нажать красную кнопку Остановить отладку вместо Перезапустить.

Изменение кода и продолжение отладки (C#, VB, C++, XAML)
В большинстве языков, поддерживаемых Visual Studio, можно изменять код во время сеанса отладки, а затем продолжать отладку.
Для использования этой функции щелкните код, чтобы установить в нем курсор, когда отладчик приостановлен,
внесите изменения и нажмите клавишу F5, F10 или F11, чтобы продолжить отладку.

## Изменение и продолжение отладки (C#, VB, C++, XAML)

В большинстве языков, поддерживаемых Visual Studio, можно изменять код во время сеанса отладки, а затем продолжать отладку. Для использования этой функции щелкните код, чтобы установить в нем курсор, когда отладчик приостановлен, внесите изменения и нажмите клавишу F5, F10 или F11, чтобы продолжить отладку.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tips-edit-and-continue.gif?view=vs-2019)

## Проверка переменных с помощью подсказок по данным
Теперь, когда вы немного освоились, у вас есть хорошая возможность проверить состояние приложения (переменные) с помощью отладчика.
Функции, позволяющие проверять переменные, являются одними из самых полезных в отладчике. Реализовывать эту задачу можно разными способами.
Часто при попытке выполнить отладку проблемы пользователь старается выяснить, хранятся ли в переменных значения, которые требуются в определенном состоянии приложения.

Приостановив работу в отладчике, наведите указатель мыши на объект, чтобы просмотреть его значение свойства
по умолчанию (в этом примере имя файла market 031.jpg является значением свойства по умолчанию).

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-data-tips.gif?view=vs-2019)

Разверните объект для просмотра его свойств (таких как свойство FullPath в этом примере).

Часто при отладке бывает необходимо быстро проверить значения свойств для объектов.
Лучше всего для этого подходят подсказки по данным.

## Проверка переменных с помощью окон "Видимые" и "Локальные"
Во время отладки взгляните на окно Видимые в нижней части редактора кода.\

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-autos-window.png?view=vs-2019)

В окне Видимые отображаются переменные вместе с текущим значением и типом. Окно Видимые содержит все переменные,
используемые в текущей строке или предыдущей строке (в C++ в окне отображаются переменные в трех предыдущих строках кода;
сведения о зависящем от языка поведении см. в соответствующей документации).

Взгляните в окно Локальные. В окне Локальные показаны переменные, которые находятся в текущей области.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-locals-window.png?view=vs-2019)

В этом примере объекты this и f находятся в области действия. Дополнительные сведения см. в статье Проверка переменных в окнах "Видимые" и "Локальные".

##Установка контрольного значения
В окне Контрольное значение можно указать переменную (или выражение), которую необходимо отслеживать.

Во время отладки щелкните правой объект кнопкой мыши и выберите пункт Добавить контрольное значение.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-watch-window.png?view=vs-2019)

В этом примере у вас есть контрольное значение, заданное для объекта f, и по мере перемещения по отладчику вы можете наблюдать за изменением его значения.
В отличие от других окон переменных, в окне Контрольное значение всегда отображаются просматриваемые вами переменные (они выделяются серым цветом, когда находятся вне области действия).

## Просмотр стека вызовов
Во время отладки щелкните окно Стек вызовов, которое по умолчанию открыто в нижней правой области.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-call-stack.png?view=vs-2019)

В окне Стек вызовов показан порядок вызова методов и функций. В верхней строке приведена текущая функция (в данном примере метод Update).
Во второй строке показано, что функция Update была вызвана из свойства Path.set и т. д. Стек вызовов хорошо подходит для изучения и анализа потока выполнения приложения.

Дважды щелкните строку кода, чтобы просмотреть исходный код. При этом также изменится текущая область, проверяемая отладчиком. Это не перемещает отладчик.

Для выполнения других задач можно воспользоваться контекстными меню из окна Стек вызовов. Например, можно вставлять точки останова в указанные функции,
перезапускать приложение с помощью функции Выполнение до текущей позиции и изучать исходный код. См. практическое руководство по просмотреть стек вызовов.

## Изучение исключения
Когда приложение выдает исключение, отладчик переходит к строке кода, вызвавшей исключение.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-exception-helper.png?view=vs-2019)

В этом примере помощник по исправлению ошибок показывает исключение System.Argument и сообщение об ошибке, где сказано, что путь имеет недопустимую форму.
Таким образом, мы знаем, что ошибка произошла в аргументе метода или функции.

В этом примере вызов DirectoryInfo выдал ошибку на пустой строке, хранящейся в переменной value.

Помощник по исправлению ошибок — это отличная функция, которая помогает отлаживать ошибки. Используя помощник по исправлению ошибок, вы также можете,
например, просмотреть сведения об ошибке и добавить контрольное значение. При необходимости вы также можете изменить условия для возникновения конкретного исключения.
См. дополнительные сведения об обработке исключений в коде в разделе Приемы и инструменты отладки.

Разверните узел Параметры исключений, чтобы просмотреть дополнительные параметры для обработки исключения этого типа, однако в рамках этого тура ничего менять не требуется.

## Настройка отладки
Вы можете настроить проект для сборки, как описано в статье о конфигурации отладки или выпуска, настроить свойства проекта для отладки или настроить общие параметры для отладки.
Кроме того, можно настроить отладчик для вывода пользовательских сведений с помощью таких компонентов, как атрибута DebuggerDisplay либо платформы NatVis для C/C++.

Свойства отладки зависят от типа проекта. Например, можно задать аргумент, который будет передан в приложение при запуске. Чтобы получить доступ к свойствам проекта приложения,
щелкните имя проекта правой кнопкой мыши в обозревателе решений и выберите Свойства. Свойства отладки обычно отображаются на вкладке Сборка или Отладка в зависимости от типа проекта.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/dbg-tour-project-properties.png?view=vs-2019)

## Отладка интерактивных приложений ASP.NET в Службе приложений Azure
Средство Snapshot Debugger создает моментальный снимок рабочих приложений при выполнении интересующего вас кода.
Чтобы указать отладчику на необходимость создать моментальный снимок, следует установить точки прикрепления и точки ведения в коде.
Отладчик позволяет увидеть источник ошибки, не затрагивая трафик рабочего приложения. Средство Snapshot Debugger позволяет значительно сократить затраты времени на устранение проблем,
возникающих в рабочих средах.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/snapshot-launch.png?view=vs-2019)

Коллекция моментальных снимков доступна для приложений ASP.NET, выполняющихся в Службе приложений Azure.
Приложения ASP.NET должны выполняться на платформе .NET Framework 4.6.1 или более поздней версии,
а приложения ASP.NET Core должны выполняться на платформе .NET Core 2.0 или более поздней версии в Windows.

## Просмотр моментальных снимков с помощью возврата на шаг назад в IntelliTrace (Visual Studio Enterprise)
Функция возврата на шаг назад в IntelliTrace автоматически создает моментальный снимок вашего приложения для каждого события точки останова и шага отладчика.
Используя записанные моментальные снимки, вы можете возвращаться к этим точкам останова и шагам, просматривая предыдущее состояние приложения.
Возможность возврата на шаг назад в IntelliTrace позволяет сэкономить время в тех случаях, когда вам нужно просмотреть предыдущее состояние приложения,
но не требуется перезапускать отладку или воссоздавать необходимое состояние приложения.

Для просмотра моментальных снимков и перехода между ними используйте кнопки На шаг назад и На шаг вперед на панели инструментов отладки.
С помощью этих кнопок можно перейти к событиям, которые отображаются на вкладке События в окне Средства диагностики.

![alt text](https://docs.microsoft.com/ru-ru/visualstudio/debugger/media/intellitrace-step-back-icons-description.png?view=vs-2019)

## Отладка проблем производительности
Если приложение работает слишком медленно или использует слишком много памяти, возможно, вам следует протестировать его с помощью средств профилирования на раннем этапе.
Дополнительные сведения о средствах профилирования, таких как средство загрузки ЦП и анализатор памяти, см. в разделе Знакомство со средствами профилирования.

Источник: https://docs.microsoft.com/ru-ru/visualstudio/debugger/debugger-feature-tour?view=vs-2019
